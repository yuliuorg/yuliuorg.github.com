<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="author" content="刘昱" />
		
		<title>刘昱 | 在gnome下用C#开发一个简单的窗口 </title>
		
		<link rel="shortcut icon" href="/media/images/siteimg/favicon.ico">
		<link href="http://yuliu.org/feed/" rel="alternate" title="刘昱" type="application/atom+xml" />
		<link rel="stylesheet" href="/media/css/style.css" type="text/css" />
		<link rel="stylesheet" href="/media/script/prettify/prettify.css" type="text/css" />
		<script type="text/javascript" src="/media/script/prettify/prettify.js"></script> 
		<script type="text/javascript" src="/media/script/jquery-1.7.2.min.js"></script>
		<!--[if IE]>
		<script type="text/javascript" src="/media/script/html5shiv.js"></script> 
		<![endif]-->		
		<script type="text/javascript" src="/media/script/default.js"></script>
		
		<!--MathJax-->
		
		<!--Google Analytics-->
		<script type="text/javascript">
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-33277878-1']);
			_gaq.push(['_setDomainName', 'yuliu.org']);
			_gaq.push(['_trackPageview']);
			_gaq.push(['_trackPageLoadTime']);
			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
		</script>
	</head>
	<body>

		<div id="container">
			<header>
			<a href="http://en.wikipedia.org/wiki/Chicago_Pile-1"><img id="siteimage" src="/media/images/siteimg/Chicago_Pile.jpg" title="Chicago Pile 1" alt="Chicago Pile 1" /></a>
			<h1>刘 昱</h1>
			<h2>核能动力系统设计工程师</h2>
			</header>
			<nav>
			<span><a title="首页" class="" href="http://yuliu.org/">主页</a></span>
			<span><a title="简历" class="" href="http://yuliu.org/vitae/">简历</a></span>
			<span><a title="文章" class="" href="http://yuliu.org/publication/">文章</a></span>
			<span><a title="关于" class="" href="http://yuliu.org/about/">关于</a></span>
			<span><a title="留言" class="" href="http://yuliu.org/guestbook/">留言</a></span>
			<span><a title="链接" class="" href="http://yuliu.org/link/">链接</a></span>
			<span><a title="杂货铺" class="" href="http://yuliu.org/essay">杂货铺</a></span>
			</nav>
			<div id="main" role="main">
				<article class="content">
				<section class="title">
<h1>在gnome下用C#开发一个简单的窗口</h1>
</section>
<section class="post">
<p>终于发现ATI的显卡驱动可以用了，于是可以不再忍受800*600的分辨率了</p>

<p>做为一个.net爱好者怎么可以不尝试一下mono呢？</p>

<p>于是apt安装mono，顺便赞一把debian</p>

<p>安装好debian以后，我写了一个简单的对话框试了试</p>

<ol>
<li><p>用monoDevelop新建工程，我的名字是gtkTest，gtk# 2.0 Project。</p></li>
<li><p>编译运行已经出现了一个gnome的窗体。不过上面什么都没有</p></li>
<li><p>Main.cs是定义程序入口的，暂时我还没有用到他。</p></li>
<li><p>打开MyWindow.cs，首先在MyWindow的构造函数中添加一个Button。</p>

<pre><code> Button mybtn = new Button("Click me");
</code></pre>

把按钮加入窗体

<pre><code> this.Add(mybtn);
</code></pre></li>
<li><p>编译运行，可以看到在窗口中已经有了一个按钮，并且是充满怎个窗口的。这里和windows是不一样的，一个窗口好象只能增加一个控件，比如说要在add一个Label在编译时刻可以通过，但是运行时刻会有Warning。而且控件大小不可调。</p></li>
<li><p>添加单击事件处理函数<br/>
构造函数中增加单击事件</p>

<pre><code> mybtn.Clicked+=new EventHandler (mybtn_click);
</code></pre>

添加事件处理的函数

<pre><code> void mybtn_click(object sender,EventArgs args)
</code></pre>

不要在里面直接用MessageBox.Show（）这个函数是没有的。<br/>
看了一下Doc，发现有一个MessageDialog，估计应该是它了。<br/>
查看构造函数，

<pre><code> MessageDialog(Window, DialogFlags, MessageType, ButtonsType, string, params object[])
</code></pre>

第一个是父窗口，第二个的意思是他的存在规则吧，我是这样理解的。<br/>
最后一个参数不知道什么意思,看他的例子也没有最后一个，我也没有写<br/>
根据example在事件处理的函数里面加上

<pre><code> MessageDialog md = new MessageDialog((Window)this,
         DialogFlags.DestroyWithParent,
         MessageType.Question,
         ButtonsType.YesNo, 
         "Do you really want to exit?");
 ResponseType result = (ResponseType)md.Run();
 md.Destroy();
 if(result==ResponseType.Yes)
 this.Destroy();
</code></pre></li>
<li><p>编译运行，在单击按钮的时候就会出现对话框问你是否确定退出。搞定
最后粘一下MyWindow.cs的代码</p>

<pre><code>  using System;
  using Gtk;

  public class MyWindow : Window
  {    
      public MyWindow () : base ("MyWindow")
      {
          this.SetDefaultSize (400, 300);
          this.DeleteEvent += new DeleteEventHandler (OnMyWindowDelete);
          Button mybtn = new Button("Click me");
          mybtn.Clicked+=new EventHandler (mybtn_click);
          this.Add(mybtn);
          this.ShowAll ();
      }

      void OnMyWindowDelete (object sender, DeleteEventArgs a)
      {
          Application.Quit ();
          a.RetVal = true;
      }

      void mybtn_click(object sender,EventArgs args)
      {
          MessageDialog md = new MessageDialog((Window)this,
                          DialogFlags.DestroyWithParent,
                          MessageType.Question,
                          ButtonsType.YesNo, 
                          "Do you really want to exit?");
          ResponseType result = (ResponseType)md.Run();
          md.Destroy();
          if(result==ResponseType.Yes)
              this.Destroy();
      }
  } 
</code></pre></li>
</ol>


</section>
<section class="meta">
<span class="author">
	<a href="http://yuliu.org">刘昱</a>
</span>
<span class="time">
	/
	
	<time datetime="2005-12-06">2005-12-06</time> 发表
	
</span>
<br />

<span class="categories">
	分类： 
	
	<a href="http://yuliu.org/essay/categories.html#计算机" title="计算机">计算机</a>&nbsp;/
	
</span>


<span class="tags">
	标签： 
	
	<a href="http://yuliu.org/essay/tags.html#C#" title="C#">C#</a>&nbsp;
	
	<a href="http://yuliu.org/essay/tags.html#mono" title="mono">mono</a>&nbsp;
	
</span>

</section>

<section class="comment">
<a href="#" id="show_disqus_comment" onclick="return false;">更多信息，请点击查看评论</a>
<div id="disqus_thread"></div>
</section>
<script type="text/javascript">
$(function(){
		$('section.comment #show_disqus_comment').on('click',function(){
			$(this).html('评论加载中<image src="/media/images/siteimg/loading.gif" class="loader-img" />');
			var disqus_shortname = 'yuliu'; // required: replace example with your forum shortname
			var disqus_url = 'http://yuliu.org/2005/12/simple_window_using_csharp_under_gnome/';
			// var disqus_developer = 1; 
			var that = this;
			// var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			var src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			PSJS.loadScript(src, function(){$(that).remove()});
			});
		});
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



<script type="text/javascript">
	$(function(){
		$(document).keydown(function(e) {
			var url = false;
			if (e.which == 37 || e.which == 74) {  // Left arrow and J
				
			}
			else if (e.which == 39 || e.which == 75) {  // Right arrow and K
				
				url = 'http://yuliu.org/2005/12/nunit_223_setting_for_testing_dotnet20/';
				
			}
			if (url) {
				window.location = url;
			}
		});
	})
</script>


				</article>
				<div id="toc"></div>
			</div>
		</div>
	</body>
</html>
